<div class="slide-layout-title">
	<h1>Constraint programming in the browser</h1>
	<h2><br>Adam Solove, @asolove</h2>
</div>
<hr>
<div>
	<h2>Improving the models that power user interfaces</h2>
</div>
<hr>
<div>
	<h2>Skin-deep change</h2>
</div>
<hr>
<div>
	<h2>Brain surgery</h2>
	<iframe src="demos/scrubbing-budget/index.html" height="600" width="1000"></iframe>
</div>
<hr>
<div>
	<h1>Outline</h1>
	<ol>
		<li>Constraint programming
		<li>Cassowary for linear constraints
		<li>Other constraint solvers
		<li>Constraints as a meta-model
	</ol>
</div>
<hr>
<div>
	<h1>Constraint programming</h1>
	<h2>Relations, not procedures</h2>
</div>
<hr>
<div>
	<h1>Addition procedure</h1>
	<pre>
		123
		+ 4
		---
	</pre>
</div>
<hr>
<div>
	<h1>Addition relation</h1>
	<pre>Forwards: 2 + 3 = x</pre>
	<pre>Backwards: x + 3 = 5</pre>
	<pre>Relation: x + y = 5</pre>
	<pre>Test: 2 + 3 = 6 => false</pre>
</div>
<hr>
<div>
	<h1>Cassowary</h1>
	<ul>
		<li>Only works on linear equations
		<li>API designed for UI applications
		<li>Very fast
		<li><a href="https://github.com/slightlyoff/cassowary-js-refactor">Alex Russell's fork</a> works in node or the browser.
	</ul>
</div>
<hr>
<div>
	<h1>Cassowary relations</h1>
	<pre class="prettyprint lang-js">var solver = new c.SimplexSolver();

var spending = new c.Variable({ value: 3598 });
var revenues = new c.Variable({ value: 2328 });
var deficit = new c.Variable({});

var balance = new c.Equation(
  c.minus(spending, revenues), 
  deficit, 
  c.Strength.required, 0);

solver.addConstraint(balance);
	</pre>

</div>
<hr>
<div>
	<h1>Cassowary interaction</h1>
	<pre class="prettyprint lang-js">
// begin to edit
solver.addEditVar(spending, c.Strength.high).beginEdit();

// make an edit
solver.suggestValue(spending, 3400).resolve();

// finish editing
solver.endEdit();

// lock a variable in place
solver.addConstraint(
  new c.StayConstraint(spending, 
                       c.Strength.required, 
                       spending.value));</pre>

</div>
<hr>
<div>
	<h1>What we've achieved</h1>
	<p>The simplest relation</p>
	<br>
	<iframe src="demos/scrubbing-budget/overview.html" height="300" width="1000"></iframe>
</div>
<hr>
<div>
	<h1>Complex relations</h1>
		<pre class="prettyprint lang-js">
var taxRates = [10, 15, 25, 28, 33, 35, 39.6];
var dollarsAtRate = [1, 2, 3, 4, 5, 6, 13];

c("taxRate0>=0");
c("taxRate6<=100");

taxRates.forEach(function(rate, i){
  c("taxRate#{i}==#{rate}", "medium");
  c("taxRate#{i}<=taxRate#{i+1}");
  c("taxRevenue#{i}==taxRate#{i}*#{dollarsAtRate[i]}");
});

c("incomeTax==" +
  taxRates.map(function(rate,i){ 
    return "taxRevenue"+i; 
  }).join("+"));

</pre>

</div>